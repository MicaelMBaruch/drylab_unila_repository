rmsf_30 = [4.865520961, 4.291246927, 3.772920417, 3.796518781, 3.074447869, 2.817119264, 3.159769041, 2.421452466, 2.996591287, 4.021670359, 3.864839659, 3.914895656, 3.784259897, 3.800760644, 4.077693204, 3.621562654, 3.006731458, 3.153787832, 2.970944322, 2.286647336, 2.298220691, 1.753303176, 1.392226587, 1.39860445, 1.506027693, 1.503692131, 1.434304972, 1.592096218, 1.640135691, 1.624692979, 1.424964745, 1.25247231, 1.251302539, 1.284288434, 1.330405635, 1.398897483, 1.116976507, 1.331251977, 1.750188746, 1.899927673, 1.921019533, 1.485561159, 1.666779848, 1.654081424, 1.808564933, 1.650062899, 1.681975938, 1.627455634, 1.787710429, 1.647724098, 1.606478447, 1.927650689, 1.873147668, 1.42886439, 1.433397987, 1.191321271, 0.99344376, 1.140783017, 1.188066329, 1.144279511, 1.297369705, 1.30335836, 1.298967619, 1.440477912, 1.525320504, 1.869240277, 1.900423502, 1.737614645, 1.901134184, 1.911773755, 1.829611603, 1.334126862, 1.158702176, 1.062256408, 0.784651298, 0.68706361, 0.612070217, 0.651383328, 0.821433821, 0.950653432, 1.158947285, 1.406630439, 1.284840297, 1.263042145, 1.173945294, 1.339304331, 1.23174347, 0.998355176, 1.177993797, 1.166702651, 0.936050459, 1.0888257, 1.372561147, 1.1888289, 0.937776305, 1.191272375, 1.481982227, 1.341723778, 1.454675016, 1.153141644, 1.164318319, 0.957855239, 0.981436493, 0.919712866, 0.864011902, 0.913592901, 0.868758975, 0.969583965, 1.015378978, 1.111088038, 1.109870848, 0.846721055, 0.904832536, 0.806628727, 0.872616833, 0.746404225, 0.639366028, 0.719199295, 0.851151423, 0.779038547, 0.712347296, 0.928041814, 1.067348624, 1.017490556, 1.09753007, 1.362635365, 1.437040025, 1.480579479, 1.665618441, 1.823517786, 1.885293021, 2.024236457, 2.269055404, 2.309407437, 2.542578095, 2.569933468, 2.252664219, 2.260965438, 2.105568309, 2.307888706, 2.375002652, 2.110966075, 1.696190403, 1.638913878, 1.555968717, 1.564255085, 1.221363212, 1.052054733, 0.810478317, 0.624702065, 0.533238013, 0.656703285, 0.920979071, 1.094210896, 0.991861746, 0.725470659, 0.842740934, 0.974204895, 0.750778933, 0.69543414, 0.939504795, 1.006523465, 0.90677798, 1.047139938, 1.302251005, 1.320126702, 1.289347143, 1.488317765, 1.529355391, 1.181403754, 1.106403474, 0.877765523, 0.762876972, 0.674925136, 0.75654954, 0.968880642, 1.259558013, 1.15743433, 1.26584455, 1.303782267, 1.439805083, 1.50629622, 1.551541408, 1.695614298, 1.48209652, 1.892752275, 1.949193305, 1.436918715, 1.4172694, 1.152561699, 1.05545438, 0.959545104, 0.895625173, 1.063889263, 1.09279009, 1.35141622, 1.559870814, 1.848249554, 2.113095652, 1.913779963, 1.848212926, 1.524567412, 1.677337028, 1.769877112, 1.702213614, 1.86757729, 1.872229411, 1.626153318, 1.420568634, 1.597103608, 1.671303688, 1.443832253, 1.452844089, 1.771662556, 1.774939738, 1.614852617, 1.81004775, 1.720365659, 1.448557332, 1.346348288, 1.273363272, 1.232338521, 1.317221366, 1.339113256, 1.464538011, 1.451264963, 1.780612801, 1.987777508, 1.787051617, 2.013700704, 1.990095481, 1.624091067, 1.497045867, 1.22187036, 1.285426087, 1.38899842, 1.650275337, 1.512910313, 1.525523293, 1.374586518, 1.121925566, 1.271353322, 1.20132858, 0.983902446, 0.900416351, 0.869472412, 0.801246139, 0.740640619, 0.759638193, 0.754204868, 0.734613358, 0.780590461, 0.903401008, 0.896236921, 1.040380698, 1.071279781, 1.237587782, 1.273598, 1.123038565, 1.099097963, 1.085953666, 0.892937154, 0.943156877, 0.995134818, 0.903324729, 0.859149944, 1.043631961, 1.190889494, 1.311774887, 1.423437255, 1.52977466, 1.543819105, 1.790641869, 1.629378822, 1.557283733, 1.828605185, 1.726085923, 1.55246278, 1.545950462, 1.423472677, 1.57860632, 1.588497787, 1.323557181, 1.335564436, 1.199721713, 1.460928792, 1.85874019, 2.606551392, 2.664069671, 3.780305299, 3.544477715, 3.723578647, 4.408467832, 4.714831798, 5.192956818, 3.999236519, 3.335694155, 3.20186802, 3.16632656, 2.495340448, 2.383697536, 2.608030355, 2.923229404, 2.671159635, 2.826365813, 3.526152268, 3.197120049, 3.637760608, 3.949188302, 3.452925322, 3.884162263, 4.058415566, 3.623573997, 3.284587464, 4.159738423, 4.439625123, 4.122352077, 4.727882006, 4.506973518, 4.361263076, 3.641459699, 3.013426556, 3.131480721, 3.237391964, 3.35802315, 3.183054427, 3.329543595, 3.362543198, 3.38162117, 3.35906115, 3.3947748, 3.919150948, 4.305047515, 5.007160032, 5.150396334, 5.460798886, 3.978991325, 3.948024464, 4.341748421, 2.819241704, 2.581073153, 2.23134813, 1.465728624, 1.096349891, 1.115939387, 0.978159715, 1.212319544, 1.205621273, 0.853175349, 1.068337426, 1.274262087, 1.054477222, 1.145103393, 1.477834162, 1.504292165, 2.241383779, 2.137930915, 2.135852743, 1.681426093, 1.664631932, 1.289432287, 1.216627447, 1.129040669, 1.198616027, 1.059832257, 0.94951019, 0.943290871, 0.927466217, 0.920546754, 0.895851696, 0.794805411, 0.870795287, 0.791519861, 0.750175299, 0.816313097, 0.824532306, 1.034866593, 1.175019601, 1.107985929, 1.252016148, 1.550782931, 1.538713945, 1.106686834, 1.003956919, 0.903531706, 0.801353295, 0.758359624, 0.761566261, 0.67076924, 0.661134078, 0.635299133, 0.630245125, 0.700771864, 0.787907447, 0.776443074, 0.811018755, 0.888558777, 0.931258835, 1.000807244, 1.07065715, 0.998192661, 1.086089493, 1.014111899, 1.08507114, 0.935401783, 0.923297341, 0.764266125, 0.739792309, 0.675333219, 0.643314967, 0.616252334, 0.569618336, 0.569600159, 0.596022999, 0.65799556, 0.705660008, 0.90293382, 0.979544126, 0.820742792, 0.906936234, 0.907968638, 0.702950446, 0.669975313, 0.581167794, 0.525456415, 0.461754108, 0.487554177, 0.635962564, 1.202792912, 1.301516859, 0.872980916, 0.84109647, 0.568489931, 0.647922829, 0.722475967, 0.742955632, 0.702221088, 0.721889562, 0.736269101, 0.623094329, 0.603849824, 0.659847547, 0.724531787, 0.760984139, 0.962631097, 0.866624125, 1.121538985, 0.889199917, 0.766066582, 0.609714133, 0.631514678, 0.712985715, 0.696922815, 0.701902251, 0.633095649, 0.616670009, 0.53508881, 0.529262891, 0.507085821, 0.534187624, 0.56782531, 0.628631267, 0.584941394, 0.584153764, 0.656370654, 0.690791034, 0.981114381, 0.888628725, 0.77677109, 0.913372768, 0.95434864, 1.096419821, 0.969209162, 0.810442566, 0.736237111, 0.864081019, 0.750894206, 0.678999118, 0.734449234, 0.663283545, 0.639437659, 0.680986306, 0.758263164, 0.803576198, 0.794494451, 0.71411732, 0.711053003, 0.740010795, 0.647240589, 0.596030056, 0.626705713, 0.632933394, 0.73635618, 0.652212153, 0.708360682, 0.743639392, 0.782218306, 0.699902264, 0.709620947, 0.853911802, 0.806775555, 0.767893828, 0.798267536, 0.848991843, 0.797746576, 0.77617748, 0.850313863, 0.89441664, 0.83170219, 0.866953149, 0.948648027, 0.953287551, 0.963349358, 0.894693513, 0.94166014, 0.751140339, 0.696636768, 0.604702541, 0.506405453, 0.408679372, 0.448091851, 0.403987983, 0.465817897, 0.482515735, 0.452532475, 0.446102097, 0.53153025, 0.542646516, 0.557691418, 0.571399129, 0.678133043, 0.709031736, 0.715277442, 0.67207128, 0.712315724, 0.699715687, 0.765203069, 0.837820768, 0.723542352, 0.663946812, 0.677768841, 0.594791206, 0.484024351, 0.454928392, 0.505242929, 0.470143076, 0.43521884, 0.442987524, 0.505225672, 0.509475271, 0.506197702, 0.532089317, 0.624392073, 0.739750758, 0.763244563, 0.670259295, 0.630013451, 0.649292062, 0.611859804, 0.606213636, 0.61651767, 0.587279104, 0.593238321, 0.661693166, 0.686115491, 0.702021979, 0.770974696, 0.851820459, 0.772741083, 0.752526515, 0.832657613, 0.947574487, 0.890038628, 0.853908021, 1.008924949, 0.988948073, 0.971457293, 0.812763041, 0.76845328, 0.683985029, 0.655280311, 0.65397546, 0.734525922, 0.721248713, 0.697529627, 0.742041942, 0.762632511, 0.798863373, 0.71690798, 0.74640355, 0.777029303, 0.766371276, 0.75373552, 0.845345093, 0.865615039, 0.864998146, 0.867316166, 0.94217361, 0.975685867, 0.954138695, 0.83189069, 0.816967996, 0.869991765, 0.847766467, 0.917542658, 2.073096213, 1.058943966, 1.193316025, 0.930298938, 0.81610319, 1.069341307, 0.896694874, 0.729769451, 0.724962349, 0.809647078, 0.819106621, 0.862823147, 0.875436988, 0.854649068, 1.125330435, 1.105777241, 0.980876949, 0.9435662, 0.876642121, 0.954619529, 1.055753677, 1.022301949, 1.16328932, 1.34723863, 1.395686007, 1.606560491, 1.556691437, 1.229714297, 1.55471709, 1.191033935, 0.922824713, 0.933032967, 0.968108249, 1.223907832, 1.509766696, 1.278454484, 0.982852804, 1.07591223, 1.163079729, 1.129155928, 0.90415278, 0.794070752, 0.817543025, 0.872005392, 0.852483803, 0.750178704, 0.785288963, 0.815126342, 0.739565935, 0.718220494, 0.764613362, 0.728432725, 0.684187888, 0.683294672, 0.755192115, 0.771347166, 0.722890967, 0.856035135, 0.903579731, 1.104018667, 1.184074387, 1.130382214, 0.98968166, 0.877090332, 0.679096242, 0.657631513, 0.741184512, 0.713569421, 0.645321227, 0.690654234, 0.73093344, 0.65356895, 0.718285474, 0.675095061, 0.660073792, 0.709820434, 1.003922484, 1.143657405, 1.046198985, 1.299610726, 1.33547633, 0.927817172, 0.792651194, 0.662962251, 0.625843784, 0.628271642, 0.590367791, 0.714141435, 0.82194588, 0.753314218, 0.645400364, 0.616696221, 0.635205069, 0.73976389, 0.77501157, 0.978853204, 0.954072716, 1.035049079, 0.812798338, 0.697738804, 0.736175459, 0.65009228, 0.557990369, 0.624730634, 0.591513703, 0.64439045, 0.81690068, 1.578604687, 1.699080469, 0.835676288, 0.657254504, 0.761309933, 0.715483634, 0.663352422, 0.711872233, 0.727441168, 0.788806657, 0.893785913, 0.765724724, 0.876484342, 0.801343997, 0.714822138, 0.771410613, 0.776637506, 0.844074806, 0.94454779, 0.917320505, 0.789001166, 0.661771214, 0.683812434, 0.720763189, 0.68978486, 0.646324371, 0.716206997, 0.770742387, 0.718917479, 0.786375674, 0.744671523, 0.896058562, 0.851822167, 0.724826232, 0.697891828, 0.73775304, 0.688388452, 0.691890435, 0.691720382, 0.768432983, 0.791618717, 0.85765052, 0.977736164, 0.971989885, 0.795485593, 0.893326889, 0.770136809, 0.729420129, 0.717638548, 0.687673189, 0.680033452, 0.714113162, 0.746862417, 0.782215055, 0.653964699, 0.703281102, 0.673786487, 0.754953189, 0.892212478, 0.751352256, 0.802855885, 0.772737646, 0.734795375, 0.754057052, 0.822897908, 0.843827188, 0.851145185, 0.686141334, 0.588920414, 0.554861778, 0.513918887, 0.516088454, 0.531147151, 0.47765821, 0.553081646, 0.618062087, 0.623279243, 0.677621274, 0.602857694, 0.5270738, 0.6887744, 0.680396785, 0.63689235, 0.650896267, 0.60371196, 0.543156899, 0.651614863, 0.706424621, 0.669681504, 0.669814869, 0.767052872, 0.782293285, 0.747155902, 0.841797337, 0.906258693, 0.897692874, 0.918153581, 1.013418341, 1.076188673, 0.894570192, 0.81443714, 0.821069922, 0.707812297, 0.613651471, 0.573846792, 0.571788677, 0.572617563, 0.605402437, 0.593204633, 0.622943472, 0.648023578, 0.632127587, 0.52377024, 0.5923357, 0.606705715, 0.807338378, 0.752876784, 0.640170294, 0.801481215, 0.830817052, 0.63115962, 0.604019844, 0.608649238, 0.591352588, 0.622667142, 0.604336212, 0.555973438, 0.683040295, 0.690689928, 0.640067403, 0.697014975, 0.778176022, 0.707880251, 0.749460867, 0.828341696, 1.023945353, 0.935261768, 0.871326774, 0.839970166, 0.677135106, 0.721398742, 0.717388385, 0.679484774, 0.786746149, 0.66932154, 0.704006373, 0.788547429, 1.071881121, 0.887321606, 0.922692928, 1.029947347, 1.167937153, 1.314923483, 1.251406306, 1.121275992, 1.178644012, 0.976940056, 0.871880266, 0.85880531, 0.720717663, 0.633534282, 0.617640463, 0.614335627, 0.59598624, 0.631449523, 0.609733124, 0.564547808, 0.574851683, 0.659269083, 0.728713401, 0.750883068, 0.902668778, 1.044537573, 1.095947136, 1.111644749, 1.057135805, 0.954132447, 1.03771803, 1.007708918, 0.895343424, 0.9853949, 0.823082283, 0.711156556, 0.699268505, 0.664519371, 0.727531001, 0.871124731, 0.976502636, 1.447558746, 1.380862326, 1.205377901, 2.157811642, 2.015911639, 2.826443999, 2.724280676, 3.153375602, 2.93800027]

input_pdb_file = r"C:\Users\Lenovo\Desktop\linker_30ºC\1aki_prod_1.pdb"

output_pdb_file = r"C:\Users\Lenovo\Desktop\linker_30ºC\DIDIT.pdb"

# Ler o arquivo PDB de entrada
with open(input_pdb_file, 'r') as pdb_in:
    lines = pdb_in.readlines()

# Abrir o arquivo PDB de saída para escrita
with open(output_pdb_file, 'w') as pdb_out:
    for line in lines:
        if line.startswith('ATOM') or line.startswith('HETATM'):
            # Dividir a linha em campos
            fields = line.split()
            atom_name = fields[2]
            residue_number = fields[5]

            # Calcular o índice baseado no número de resíduo
            residue_index = int(residue_number) - 1

            # Obter o valor RMSF correspondente
            rmsf = rmsf_30[residue_index]

            # Formatar o valor RMSF como um fator B
            b_factor = f'{rmsf:.2f}'

            # Substituir os fatores B na linha
            line = f'{line[:61]}{b_factor:>6}{line[67:]}'

        # Escrever a linha no arquivo de saída
        pdb_out.write(line)

print(f'Arquivo PDB com B-factors atualizados salvo como {output_pdb_file}')